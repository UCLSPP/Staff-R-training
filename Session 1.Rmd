---
title: "R training for SPP staff (session 1)"
author: "Javier Sajuria"
date: "2 December 2015"
output: html_document
---

## Introduction to R

### Scalar objects

```{r}
# Create a numeric and a character variable
a <- 5 
class(a) # a is a numeric variable
a
b <- "Yay stats class"
class(b) # b is a string variable
b
```

Save your script, and re-open it to make sure your changes are still there.

### Vectors and subsetting

```{r}
# Create a vector
my.vector <- c(10,-7,99,34,0,-5) # a vector
my.vector
length(my.vector) # how many elements?
# subsetting
my.vector[1] # 1st vector element
my.vector[-1] # all elements but the 1st
my.vector[2:4] # the 2nd to the 4th elements
my.vector[c(2,5)] # 2nd and 5th element
my.vector[length(my.vector)] # the last element

# delete variable 'a' from workspace
rm(a)
# delete everything from workspace
rm(list=ls())
```


### Matrices
```{r}
# create a matrix
# type help("matrix") into the console and press ENTER
# read Description, Usage and Arguments
my.matrix1 <- matrix(data = c(1,2,30,40,500,600), nrow = 3, ncol = 2, byrow = TRUE,
                     dimnames = NULL)
my.matrix2 <- matrix(data = c(1,2,30,40,500,600), nrow = 2, ncol = 3, byrow = FALSE)
# How are the matrices different?
my.matrix1
my.matrix2

# subsetting a matrix
my.matrix1[1,2] # element in row 1 and column 2
my.matrix1[2,1] # element in row 2 and column 1
my.matrix1[,1] # 1st column only
my.matrix1[1:2,] # rows 1 to 2
my.matrix1[c(1,3),] # rows 1 and 3 
```


### Installing and loading packages

Packages are user-generated pieces of code that expand the basic options of R. R is a very flexible language, that allows to go way beyond the base options.

```{r, eval=FALSE}
install.packages("texreg") # Creates tables both in ASCII text, LaTeX or Word, similar to outreg
install.packages("lmtest") # Provides different tests of linear models
install.packages("readxl") # Opens and writes Excel files
```

In some cases, we want to install previous versions of packages. In this case, we will install Zelig, a comprehensive package that we will use to estimate and plot predicted probabilities. We will install the same version we are using to teach the MSc students:

```{r, eval=FALSE}

install.packages("https://cran.r-project.org/src/contrib/Archive/Zelig/Zelig_4.2-1.tar.gz", 
                 repos=NULL, 
                 type="source")

```

Once packages are installed, they need to be loaded. The reason is that some packages have overlapping functions with others, so we usually care about the order in which we load them

```{r}
library(foreign) ## comes with the basic installation and allows us to open files in other formats such as Stata, SPSS or SAS
library(readxl)
library(texreg)
library(Zelig)
```

### Setting up youw roking directory and (down)loading data

To set up your working directory, you need to use the `setwd()` function. E.g.:

```
setwd("~/R seminar")
```

```{r, echo=FALSE, message=FALSE}
setwd("~/Dropbox/UCL/SPP staff R sessions")
```

One traditional format of data os CSV. These files do not contain any metadata, but they are usually compatible with any statistical software. The way to load a dataset is assigning it to an object (of class `dataframe`). For CSVs, we use `read.csv()`:

```{r}
# load the Polity IV dataset
my.data <- read.csv("http://uclspp.github.io/PUBLG100/data/polity.csv")

# View(my.data) # opens a window with the data set
head(my.data) # retrieves the first 6 observations
head(my.data, n=10) # you can manually set up the amount of observations shown

tail(my.data) # retrieves the last 6 observations


```

In dataframes, we can use the `$` instead of the `[]` to subset a single column (i.e. a variable):

```{r}
head(my.data$country)
head(my.data$polity2)
```

We can use the `read_excel` function from the `readxl` package to open Excel files. However, unlike with what we did for CSV files, the `read_excel` function does not directly download files, so we need to save them into our working directory. 

<a href="http://uclspp.github.io/PUBLG100/data/hsb2.xlsx" type="button" class="btn btn-success">Download 'High School and Beyond' Dataset</a>

Make sure you save it into your working directory and then run:

```{r}
student_data <- read_excel("hsb2.xlsx")

head(student_data)
```

To open Stata files, we can use the `read.dta()` function:

```{r}
world.data <- read.dta("http://uclspp.github.io/PUBLG100/data/QoG2012.dta")
head(world.data)
```

## Descriptive stats

summary, desc

## Regression

## Panel data

## logit

## Generating and plotting predicted probabilities